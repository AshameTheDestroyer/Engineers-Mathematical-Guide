import{v as T,k as B,n as L,j as e,B as S,L as p,F as f,t as _,d as E,b as F,D as G,l as M,u as P,m as R}from"./index-zHgfL_3a.js";import{b as C,C as D}from"./CoursesDisplay-Cu_FWHVA.js";import{u as z,L as q}from"./useGetLearningTrackByID-CLFGtyHH.js";import{u as $}from"./useShadow-UFMsQS_A.js";import{P as A}from"./ProgressBar-BdeibbVD.js";import{u as O}from"./useGetCourseByID-PPrymWsC.js";import{u as V,f as J}from"./useGetModulesByIDs-DuEmMbE3.js";import{B as U}from"./BlurredContainer-vsUyr8x0.js";import{u as H}from"./useGetEnrollmentByID-uQyxT0sO.js";import{s as K}from"./variant_success-Cukf3QWI.js";import{l as s}from"./learning_tracks_page-C66Wtpdr.js";import{u as Q}from"./useGetCoursesByIDs-Bw58nCXX.js";import{S as v}from"./SearchResultDisplay-DDPfNVuh.js";import"./CardSummary-CaxloyyP.js";import"./Rating-Cr_m_B1W.js";import"./star-B-UdhycM.js";import"./user-BgdDnp0D.js";import"./Image-DoldvkPH.js";import"./network_error-BFEUb7Sm.js";import"./courses_page-CmId8-xS.js";import"./LearningTrackSchema-D2dFUQ07.js";import"./CourseSchema-BNzzUGNt.js";import"./courses.dummy-zCi7JDTP.js";import"./RichText-BqXbsrWa.js";const W=({id:m,ref:n,courseID:l,className:a})=>{const x=$(),b=T(),{myUser:o}=B(),{isDarkThemed:d}=L(),{refetch:y,isError:h,isLoading:j,data:r}=O(l,{usesSuspense:!0}),{data:i}=H(r==null?void 0:r.id,o==null?void 0:o.username,{enabled:r!=null,usesSuspense:!0}),{data:I}=V((r==null?void 0:r.modules)??[],{enabled:r!=null,usesSuspense:!0}),c=(i==null?void 0:i.progress.reduce((t,g)=>t+g["finished-lessons"],0))??0,u=I.reduce((t,g)=>t+g["lesson-count"],0),k=i!=null&&i.progress.every(t=>t.grade!=null)?i.progress.reduce((t,g)=>t+g.grade,0)/i.progress.length:void 0,w=i!=null,N=c==u&&k!=null;return j||r==null?e.jsx(C,{className:"aspect-square",isSkeleton:!0}):h?e.jsx(S,{onClick:t=>y(),children:e.jsx(p,{children:s.profile.courses.error.button})}):e.jsxs(f,{id:m,ref:n,className:_("border-background-darker relative cursor-pointer rounded-lg border-2 p-6 text-white transition duration-200 [&:is(:hover,:focus-within)]:scale-105",d?"bg-background-normal/50":"bg-foreground-darker/75",a),gap:"8",direction:"column",style:{boxShadow:x},onClick:t=>b(G.base.routes.courseID.MapVariable(r.id)),children:[k!=null&&e.jsx("span",{className:"z-1 bg-vibrant-green-normal border-vibrant-green-dark absolute left-2.5 top-2.5 flex aspect-square min-w-[calc(5ch+0.75rem)] -translate-x-1/2 -translate-y-1/2 place-content-center place-items-center rounded-full border-2 text-center font-bold text-white",children:e.jsxs("p",{className:"scale-80",children:[Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(k),"%"]})}),e.jsx(U,{className:"-m-6 aspect-square h-auto w-auto rounded-lg",blurType:o==null?"none":"bottom",children:e.jsx(C,{className:"[&:is(:hover,:focus-within)]:scale-100! h-full w-full rounded-lg",course:r})}),w?e.jsxs(f,{className:"grow",direction:"column",gap:"4",placeContent:"end",children:[e.jsxs(E,{className:"text-lg font-bold",variant:"h4",children:[e.jsx(p,{children:s.profile.courses.progress})," (",c,"/",u,")"]}),e.jsx(A,{className:F("my-4 w-[calc(100%-3rem)] place-self-center max-md:[&_[data-checkpoint]:not(:nth-of-type(2))]:scale-75 md:[&_[data-checkpoint]:nth-of-type(2)]:scale-125",c!=u&&c>0?"[&_[data-checkpoint]:nth-of-type(2)]:z-1":"[&_[data-checkpoint]:last-of-type]:z-1"),minimum:0,maximum:u,value:c,variant:N?"success":w?"secondary":"default",checkpoints:[c,{value:0,icon:{source:J}},N?{icon:{source:K},value:u}:u]})]}):o!=null&&e.jsxs(f,{direction:"column",gap:"4",children:[e.jsx(p,{className:"text-lg font-bold",variant:"h4",gender:o.gender,children:s.profile.courses.unenrollment.title}),e.jsx(p,{variant:"p",gender:o.gender,children:s.profile.courses.unenrollment.paragraph})]})]})},ke=()=>{const{learningTrackID:m}=M(),{language:n,GetLocale:l}=P(),{data:a}=z(m,{usesSuspense:!0}),{refetch:x,isError:b,isLoading:o,data:d}=Q((a==null?void 0:a.courses)??[],{enabled:a!=null}),y=new Array(5).fill(null);return a==null?e.jsx(v,{className:"grow",iconType:"empty",title:l(s.display.empty.title,n),paragraph:l(s.display.empty.paragraph,n).replace(/\*\*([^\*]+)\*\*/,`**"${m}"**`)}):e.jsxs(f,{className:"grow",variant:"main",direction:"column",gap:"8",children:[e.jsx(R,{children:`Courses of ${a.title}`}),e.jsx(q,{learningTrack:a}),e.jsx(p,{className:"text-2xl font-bold",variant:"h1",children:s.profile.courses.title}),o||d==null?e.jsx(D,{isSkeleton:!0,courses:y}):b?e.jsx(v,{className:"grow",iconType:"error",title:l(s.profile.courses.error.title,n),paragraph:l(s.profile.courses.error.paragraph,n),buttons:e.jsx(S,{onClick:h=>x(),children:e.jsx(p,{children:s.profile.courses.error.button})})}):d.length==0?e.jsx(v,{className:"grow",iconType:"empty",title:l(s.profile.courses.empty.title,n),paragraph:l(s.profile.courses.empty.paragraph,n).replace(/\*\*([^\*]+)\*\*/,`**"${m}"**`)}):e.jsx(D,{courses:d,Renders:(h,j)=>e.jsx(W,{courseID:h.id},j)})]})};export{ke as LearningTrackCoursesPage};
