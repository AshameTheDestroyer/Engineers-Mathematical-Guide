import{v as y,u as _,r as w,j as e,b as u,F as m,q as S,d as h,A as T,l as L,k as B,m as D,I as M,B as b,L as p,D as f,w as A,x as O}from"./index-nnsqk7fk.js";import{B as P}from"./BorderedList-C8KtUzNp.js";import{C as z}from"./CourseBanner-6QTj6p0b.js";import{S as G}from"./Separator-O0iqxH4q.js";import{B as U}from"./ButtonBox-C60GYIw0.js";import{u as K}from"./useGetCourseByID-CCEaNDY_.js";import{u as Q}from"./useColour-DBpEqmBO.js";import{P as V}from"./ProfileAvatar-nvvgPEYp.js";import{m as $,a as F,b as H}from"./medal_second_place-Coqlc4z7.js";import{u as Y}from"./useGetUsersByIDs-o-fNm6rF.js";import{R as J}from"./RelatedCoursesDisplay-DUeyzCN1.js";import{u as W}from"./useGetCourses-CZsfkwjf.js";import{u as I}from"./useGetCoursesByIDs-DiRREiKX.js";import{S as X}from"./SearchResultDisplay-wzQgFH3C.js";import{a as Z}from"./arrow-CEXDshSc.js";import{r as ee,a as ae,l as te}from"./CoursesDisplay-DYaxwXo0.js";import{l as n}from"./courses_page-CmId8-xS.js";import"./CardSummary-BxpknUdD.js";import"./Rating-DhRd7vuJ.js";import"./star-B-UdhycM.js";import"./user-BgdDnp0D.js";import"./Image-CDeMuw6I.js";import"./network_error-BFEUb7Sm.js";import"./CourseSchema-CmAgyUCf.js";import"./CreateFilterFunction-CUEokTdJ.js";import"./courses.dummy-zCi7JDTP.js";import"./RichText-fayepGf1.js";import"./useShadow-CPP0YPML.js";const re=[$,F,H],se=({rank:a,student:s,isSkeleton:t})=>{const o=y(),{direction:l}=_(),r=w.useRef(null),i={button:["bg-material-gold-light active:bg-material-gold-dark [&:where(:hover,:focus-within)]:bg-material-gold-normal","bg-material-silver-light active:bg-material-silver-dark [&:where(:hover,:focus-within)]:bg-material-silver-normal","bg-material-bronze-light active:bg-material-bronze-dark [&:where(:hover,:focus-within)]:bg-material-bronze-normal"],bullet:["[&_.icon]:text-material-gold-light [&:active_.icon]:text-material-gold-dark [&:where(:hover,:focus-within)_.icon]:text-material-gold-normal","[&_.icon]:text-material-silver-light [&:active_.icon]:text-material-silver-dark [&:where(:hover,:focus-within)_.icon]:text-material-silver-normal","[&_.icon]:text-material-bronze-light [&:active_.icon]:text-material-bronze-dark [&:where(:hover,:focus-within)_.icon]:text-material-bronze-normal"]},{isDarkColour:x}=Q({updateDelay:250,reference:r,className:i.button[a-1]});return e.jsxs("button",{ref:r,className:u(l=="ltr"?"ml-22 max-sm:ml-10":"mr-22 max-sm:mr-10",x?"text-white":"text-black","bg-background-normal relative flex grow place-content-evenly gap-4 rounded-full p-2 transition duration-200 max-sm:gap-1","[&_.icon]:text-background-normal",t?"animate-pulse":"active:bg-background-normal-active [&:where(:hover,:focus-within)]:bg-background-normal-hover [&:active_.icon]:text-background-normal-active [&:where(:hover,:focus-within)_.icon]:text-background-normal-hover cursor-pointer",!t&&i.button[a-1],!t&&i.bullet[a-1]),tabIndex:t?-1:0,onClick:g=>!t&&o(T.base.routes.profileID.MapVariable(s.username)),children:[e.jsx(m,{className:u(!t&&i.bullet[a-1],l=="ltr"?"-left-22 translate-x-[10%] max-sm:-left-10 max-sm:-ml-8":"-right-22 -translate-x-[10%] max-sm:-right-10 max-sm:-mr-8","max-sm:text-md absolute top-1/2 aspect-square h-[80%] -translate-y-1/2 text-lg"),placeItems:"center",placeContent:"center",children:a<=3&&!t?e.jsx(S,{className:"border-3 h-full w-full overflow-hidden rounded-full transition duration-200 max-sm:scale-75 [&>svg]:h-full [&>svg]:w-full [&>svg]:-translate-y-1",thickness:1.5,source:re[a-1]}):e.jsxs(h,{className:"text-foreground-darker font-semibold not-italic",variant:"i",children:["#",a]})}),e.jsx(V,{className:u(t&&"[&>div]:rotate-y-0! [&>div]:saturate-0","scale-70 aspect-square h-full bg-inherit"),user:s,flipType:"hover"}),e.jsxs(m,{className:u(t&&"opacity-0","overflow-hidden"),direction:"column",placeContent:"start",children:[e.jsx(h,{className:u(l=="ltr"?"text-start":"text-end","max-sm:text-md w-fit overflow-hidden text-ellipsis whitespace-nowrap text-start text-lg font-bold [direction:ltr]"),variant:"strong",children:t?"skeleton":`${s.name} ${s.surname??""}`}),e.jsxs(h,{className:u(l=="ltr"?"text-start":"text-end","w-fit overflow-hidden text-ellipsis whitespace-nowrap text-start [direction:ltr]"),variant:"p",children:["@",s.username]})]}),e.jsxs(h,{className:u(t&&"opacity-0",l=="ltr"?"ml-auto mr-2 max-sm:mr-1":"ml-2 mr-auto max-sm:ml-1","max-sm:text-md flex aspect-square place-content-center place-items-center text-lg font-bold"),variant:"em",children:[Math.round(s.grade),"%"]})]})},j=({title:a,isSkeleton:s,"top-10-students":t})=>{const{data:o}=Y(t.map(l=>l.username),{usesSuspense:!s,transform:l=>l.map(r=>{var i;return{...r,grade:((i=t.find(x=>x.username==r.username))==null?void 0:i.grade)??0}})});return e.jsxs(m,{variant:"section",direction:"column",gap:"8",children:[e.jsx(h,{className:"text-lg font-bold",variant:"h2",children:a}),e.jsx("ol",{className:"space-y-4",children:(s?t:o).map((l,r)=>e.jsx(m,{variant:"li",children:e.jsx(se,{rank:r+1,isSkeleton:s,student:l})},r))})]})},le=5,ie="get-similar-courses",oe=(a,s=le,t,o)=>W(a==null?void 0:a.tags.join(" "),{transform:l=>{var r;return(r=l==null?void 0:l.filter(i=>i.id!=(a==null?void 0:a.id)))==null?void 0:r.slice(0,s)},...t??{},queryKey:[ie,a==null?void 0:a.id,...(t==null?void 0:t.queryKey)??[]]},o),ne="get-prerequisite-courses",ce=(a,s,t)=>I((a==null?void 0:a.prerequisites)??[],{...s??{},queryKey:[ne,a==null?void 0:a.id,...(s==null?void 0:s.queryKey)??[]]},t),me="get-postrequisite-courses",de=(a,s,t)=>I((a==null?void 0:a.postrequisites)??[],{...s??{},queryKey:[me,a==null?void 0:a.id,...(s==null?void 0:s.queryKey)??[]]},t),ue="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='32'%20height='32'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='currentColor'%20d='M5.5%202H17a2.5%202.5%200%200%201%202.5%202.5v6.813a6.5%206.5%200%200%200-8.187%208.187H4.5a1%201%200%200%200%201%201h6.232A6.5%206.5%200%200%200%2012.81%2022H5.5A2.5%202.5%200%200%201%203%2019.5v-15A2.5%202.5%200%200%201%205.5%202M7%205a1%201%200%200%200-1%201v1a1%201%200%200%200%201%201h8a1%201%200%200%200%201-1V6a1%201%200%200%200-1-1zm16%2012.5a5.5%205.5%200%201%200-11%200a5.5%205.5%200%200%200%2011%200m-6.086-2.403l2.806%201.84q.131.084.205.223q.075.136.075.298a.65.65%200%200%201-.072.298a.6.6%200%200%201-.198.226l-2.807%201.915a.6.6%200%200%201-.158.077a.55.55%200%200%201-.395-.023a.7.7%200%200%201-.193-.135a.7.7%200%200%201-.13-.2a.6.6%200%200%201-.047-.237v-3.758a.62.62%200%200%201%20.367-.57a.55.55%200%200%201%20.547.045'%20/%3e%3c/svg%3e",Ge=5,Ue=5,Ke=5,Qe=()=>{const a=y(),{direction:s,GetLocale:t,language:o}=_(),{courseID:l}=L(),{data:r}=K(l,{usesSuspense:!0}),{myUser:i}=B(),x=l!=null&&(i==null?void 0:i["bookmarked-courses"].includes(l)),g=l!=null&&(i==null?void 0:i["enrolled-courses"].includes(l)),v=l!=null&&(i==null?void 0:i["finished-courses"].includes(l)),k=oe(r,void 0,{enabled:r!=null}),C=ce(r,{enabled:r!=null}),N=de(r,{enabled:r!=null}),E=new Array(5).fill(null),R=[{query:k,locales:n.profile["related-courses"].similar},{query:C,locales:n.profile["related-courses"].prerequisites},{query:N,locales:n.profile["related-courses"].postrequisites}];if(r==null)return e.jsx(X,{className:"grow",iconType:"empty",title:t(n.display.empty.title,o),paragraph:t(n.display.empty.paragraph,o).replace(/\*\*([^\*]+)\*\*/,`**"${l}"**`)});const q=c=>{const d=n.profile["related-courses-error"];return e.jsxs(m,{className:"lg:col-span-2",gap:"4",direction:"column",children:[e.jsx(p,{className:"text-lg font-bold",variant:"h2",children:c.locales.title}),e.jsx(J,{...c.query,skeletonArray:E,errorDisplay:{title:t(d.title,o),button:t(d.button,o),paragraph:t(d.paragraph,o)},emptyDisplay:{title:t(c.locales.empty.title,o),paragraph:t(c.locales.empty.paragraph,o).replace(/\*\*([^\*]+)\*\*/,`**"${r.title}"**`)}})]})};return e.jsxs(m,{variant:"main",direction:"column",gap:"8",children:[e.jsx(D,{children:r.title}),e.jsx(z,{course:r,children:i!=null&&e.jsxs(U,{className:u("absolute bottom-0 z-[1] translate-y-1/2 max-sm:gap-2",s=="ltr"?"right-[6vw]":"left-[6vw]"),children:[e.jsx(M,{className:"[&>div]:p-2",isSquare:!0,thickness:"thick",variant:x?"error":"success",icon:{source:x?ee:ae}}),!v&&e.jsx(b,{thickness:"thick",variant:g?"default":"primary",icon:g?void 0:{placement:"left",source:ue},children:e.jsx(p,{children:g?n.profile.buttons.deroll:n.profile.buttons["enroll-now"]})}),(g||v)&&e.jsx(b,{thickness:"thick",disabled:r.locked,variant:r.locked?"default":"primary",onClick:c=>a(f.base.routes.modules.MapVariables({courseID:l})),icon:{className:r.locked?"":s=="ltr"?"rotate-90":"-rotate-90",placement:"right",source:r.locked?te:Z},children:e.jsx(p,{children:n.profile.buttons.open})})]})}),e.jsxs("main",{className:"gap-page grid grid-cols-2 max-lg:grid-cols-1",children:[e.jsxs(m,{variant:"section",direction:"column",gap:"8",children:[e.jsxs(m,{direction:"column",gap:"4",children:[e.jsx(p,{className:"text-lg font-bold",variant:"h2",children:n.profile.introduction}),e.jsx(h,{className:s=="rtl"?"text-end":"",variant:"p",dir:"ltr",children:r.description})]}),e.jsxs(m,{direction:"column",gap:"4",children:[e.jsx(p,{className:"text-lg font-bold",variant:"h2",children:n.profile.description}),e.jsx(h,{className:"text-justify",dir:"ltr",variant:"p",children:r["detailed-description"]})]}),e.jsxs(m,{direction:"column",gap:"4",children:[e.jsx(p,{className:"text-lg font-bold",variant:"h2",children:n.profile.modules}),e.jsx(P,{list:r.modules.map(c=>({title:c.replace(/^[^-]*-/,"").toTitleCase(),path:f.base.routes.moduleID.MapVariables({courseID:r.id,moduleID:c.replace(/^[^-]*-/,"")})}))})]}),e.jsxs(m,{direction:"column",gap:"4",children:[e.jsx(p,{className:"text-lg font-bold",variant:"h2",children:n.profile.tags}),e.jsx(m,{gap:"3",wrap:"wrap",children:r.tags.map((c,d)=>e.jsx(A,{className:"bg-background-dark active:bg-background-normal-active [&:where(:hover,:focus-within)]:bg-background-normal-hover cursor-pointer rounded-full px-3 py-1 transition duration-200",to:f.base.routes.courses.absolute+"?"+new URLSearchParams({query:c}),children:c},d))})]})]}),e.jsx(O,{skeleton:e.jsx(j,{isSkeleton:!0,title:t(n.profile["top-10-students"],o),"top-10-students":new Array(10).fill(null).map(()=>({username:"",grade:0}))}),children:e.jsx(j,{"top-10-students":r["top-10-students"],title:t(n.profile["top-10-students"],o)})}),e.jsx(m,{className:"lg:col-span-2",direction:"column",gap:"4",children:R.map((c,d)=>e.jsxs(w.Fragment,{children:[d>0&&e.jsx(G,{className:"border-background-dark-hover",thickness:"thick",orientation:"horizontal"}),e.jsx(q,{...c})]},d))})]})]})};export{Qe as CoursePage,Ke as POSTREQUISITE_COURSES_LIMIT,Ue as PREREQUISITE_COURSES_LIMIT,Ge as SIMILAR_COURSES_LIMIT};
